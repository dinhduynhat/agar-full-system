(function(g,v){function ra(){da();setInterval(da,18E4);A=O=document.getElementById("canvas");d=A.getContext("2d");A.onmousedown=function(a){if(ea){var b=a.clientX-(5+m/5/2),c=a.clientY-(5+m/5/2);if(Math.sqrt(b*b+c*c)<=m/5/2){G();C(17);return}}P=a.clientX;Q=a.clientY;R();G()};A.onmousemove=function(a){P=a.clientX;Q=a.clientY;R()};A.onmouseup=function(a){};var a=!1,b=!1,c=!1;g.onkeydown=function(f){32!=f.keyCode||a||(G(),C(17),a=!0);81!=f.keyCode||b||(C(18),b=!0);87!=f.keyCode||c||(G(),C(21),c=!0)};g.onkeyup=function(f){32==f.keyCode&&(a=!1);87==f.keyCode&&(c=!1);81==f.keyCode&&b&&(C(19),b=!1)};g.onblur=function(){C(19);c=b=a=!1};g.onresize=fa;fa();g.requestAnimationFrame?g.requestAnimationFrame(ga):setInterval(S,1E3/60);setInterval(G,100);ha(v("#region").val())}function sa(){for(var a=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY,d=0,e=0;e<r.length;e++)d=Math.max(r[e].size,d),a=Math.min(r[e].x,a),b=Math.min(r[e].y,b),c=Math.max(r[e].x,c),f=Math.max(r[e].y,f);T=QUAD.init({minX:a-(d+100),minY:b-(d+100),maxX:c+(d+100),maxY:f+(d+100)});for(e=0;e<r.length;e++)if(a=r[e],a.shouldRender())for(b=0;b<a.points.length;++b)T.insert(a.points[b])}function R(){J=(P-m/2)/s+w;K=(Q-p/2)/s+x}function da(){null==L&&(L={},v("#region").children().each(function(){var a=v(this),b=a.val();b&&(L[b]=a.text())}));v.get("http://m.agar.io/info",function(a){for(var b in a.regions)v('#region option[value="'+b+'"]').text(L[b]+" ("+a.regions[b].numPlayers+" players)")},
"json")}function ha(a){a&&a!=U&&(U=a,ia())}function ja(){v.ajax("http://m.agar.io/",{error:function(){setTimeout(ja,1E3)},success:function(a){a=a.split("\n");ka("ws://"+a[0])},dataType:"text",method:"POST",cache:!1,crossDomain:!0,data:U||"?"})}function ia(){v("#connecting").show();ja()}function ka(a){h&&(h.onopen=null,h.onmessage=null,h.onclose=null,h.close(),h=null);D=[];n=[];y={};r=[];E=[];z=[];console.log("Connecting to "+a);h=new WebSocket(a);h.binaryType="arraybuffer";h.onopen=ta;h.onmessage=ua;h.onclose=va;h.onerror=function(){console.log("socket error")}}function ta(a){v("#connecting").hide();console.log("socket open");a=new ArrayBuffer(5);var b=new DataView(a);b.setUint8(0,255);b.setUint32(1,1,!0);h.send(a);la()}function va(a){console.log("socket close");setTimeout(ia,500)}function ua(a){function b(){for(var a="";;){var b=f.getUint16(c,!0);c+=2;if(0==b)break;a+=String.fromCharCode(b)}return a}var c=1,f=new DataView(a.data);switch(f.getUint8(0)){case 16:wa(f);break;case 20:n=[];D=[];break;case 32:D.push(f.getUint32(1,!0));break;case 48:for(z=[];c<f.byteLength;)z.push(b());xa();break;case 64:V=f.getFloat64(1,!0),W=f.getFloat64(9,!0),X=f.getFloat64(17,!0),Y=f.getFloat64(25,!0),0==n.length&&(w=(X+V)/2,x=(Y+W)/2)}}function wa(a){F=+new Date;var b=Math.random(),c=1;Z=!1;for(var f=a.getUint16(c,!0),c=c+2,d=0;d<f;++d){var e=y[a.getUint32(c,!0)],t=y[a.getUint32(c+4,!0)],c=c+8;e&&t&&(t.destroy(),t.ox=t.x,t.oy=t.y,t.oSize=t.size,t.nx=e.x,t.ny=e.y,t.nSize=t.size,t.updateTime=F)}for(;;){f=
a.getUint32(c,!0);c+=4;if(0==f)break;var d=a.getFloat64(c,!0),c=c+8,e=a.getFloat64(c,!0),c=c+8,t=a.getFloat64(c,!0),c=c+8,k=a.getUint8(c++),h=!1;if(0==k)h=!0,k="#33FF33";else if(255==k)var h=a.getUint8(c++),k=a.getUint8(c++),g=a.getUint8(c++),k=ma(h<<16|k<<8|g),h=!!(a.getUint8(c++)&1);else{var k=63487|k<<16,l=(k>>16&255)/255*360,m=(k>>8&255)/255,k=(k>>0&255)/255;if(0==m)k=k<<16|k<<8|k<<0;else{var l=l/60,g=~~l,u=l-g,l=k*(1-m),s=k*(1-m*u),m=k*(1-m*(1-u)),p=u=0,q=0;switch(g%6){case 0:u=k;p=m;q=l;break;
case 1:u=s;p=k;q=l;break;case 2:u=l;p=k;q=m;break;case 3:u=l;p=s;q=k;break;case 4:u=m;p=l;q=k;break;case 5:u=k,p=l,q=s}u=~~(255*u)&255;p=~~(255*p)&255;q=~~(255*q)&255;k=u<<16|p<<8|q}k=ma(k)}for(g="";;){l=a.getUint16(c,!0);c+=2;if(0==l)break;g+=String.fromCharCode(l)}l=null;y.hasOwnProperty(f)?(l=y[f],l.updatePos(),l.ox=l.x,l.oy=l.y,l.oSize=l.size,l.color=k):l=new na(f,d,e,t,k,h,g);l.nx=d;l.ny=e;l.nSize=t;l.updateCode=b;l.updateTime=F;-1!=D.indexOf(f)&&-1==n.indexOf(l)&&(document.getElementById("overlays").style.display="none",n.push(l),1==n.length&&(w=l.x,x=l.y))}a.getUint16(c,!0);c+=2;e=a.getUint32(c,!0);c+=4;for(d=0;d<e;d++)f=a.getUint32(c,!0),c+=4,y[f]&&(y[f].updateCode=b);for(d=0;d<r.length;d++)r[d].updateCode!=b&&r[d--].destroy();Z&&0==n.length&&v("#overlays").fadeIn(3E3)}function G(){if(null!=h&&h.readyState==h.OPEN&&(oa!=J||pa!=K)){oa=J;pa=K;var a=new ArrayBuffer(21),b=new DataView(a);b.setUint8(0,16);b.setFloat64(1,J,!0);b.setFloat64(9,K,!0);b.setUint32(17,0,!0);h.send(a)}}function la(){if(null!=h&&h.readyState==h.OPEN&&null!=H){var a=new ArrayBuffer(1+2*H.length),b=new DataView(a);b.setUint8(0,0);for(var c=0;c<H.length;++c)b.setUint16(1+2*c,H.charCodeAt(c),!0);h.send(a)}}function C(a){if(null!=h&&h.readyState==h.OPEN){var b=new ArrayBuffer(1);(new DataView(b)).setUint8(0,a);h.send(b)}}function ga(){S();g.requestAnimationFrame(ga)}function fa(){m=g.innerWidth;p=g.innerHeight;O.width=A.width=m;O.height=A.height=p;S()}function ya(){for(var a=0,b=0;b<n.length;b++)a+=n[b].size;a=Math.pow(Math.min(64/a,1),.4)*Math.max(p/965,m/1920);s=(9*s+a)/10}function S(){var a=+new Date;++za;ya();F=+new Date;sa();if(0<n.length){for(var b=0,c=0,f=0;f<n.length;f++)n[f].updatePos(),b+=n[f].x/n.length,c+=n[f].y/n.length;w=(w+b)/2;x=(x+c)/2}R();d.clearRect(0,0,m,p);d.fillStyle=$?"#111111":"#F2FBFF";d.fillRect(0,0,m,p);d.save();d.strokeStyle=$?"#AAAAAA":"#000000";d.globalAlpha=.2;d.scale(s,s);b=m/s;c=p/s;for(f=-.5+(-w+b/2)%50;f<b;f+=50)d.beginPath(),d.moveTo(f,0),d.lineTo(f,c),d.stroke();for(f=-.5+(-x+c/2)%50;f<c;f+=50)d.beginPath(),
d.moveTo(0,f),d.lineTo(b,f),d.stroke();d.restore();r.sort(function(a,b){return a.size==b.size?a.id-b.id:a.size-b.size});d.save();d.translate(m/2,p/2);d.scale(s,s);d.translate(-w,-x);for(f=0;f<E.length;f++)E[f].draw();for(f=0;f<r.length;f++)r[f].draw();d.restore();B&&0!=z.length&&d.drawImage(B,m-B.width-10,10);I=Math.max(I,Aa());0!=I&&(c="Score: "+~~(I/100),d.font="24px Ubuntu",d.fillStyle="#000000",d.globalAlpha=.2,b=d.measureText(c).width,d.fillRect(m/2-b/2-5,p-10-24-10,b+10,34),d.globalAlpha=1,d.fillStyle="#FFFFFF",d.fillText(c,m/2-b/2,p-10-8));Ba();a=+new Date-a;a>1E3/60?q-=.01:a<1E3/65&&(q+=.01);.4>q&&(q=.4);1<q&&(q=1)}function Ba(){if(ea&&aa.width){var a=m/5;d.drawImage(aa,5,5,a,a)}}function Aa(){for(var a=0,b=0;b<n.length;b++)a+=n[b].nSize*n[b].nSize;return a}function xa(){if(0!=z.length){B=document.createElement("canvas");var a=B.getContext("2d"),b=60+24*z.length,c=Math.min(200,.3*m)/200;B.width=200*c;B.height=b*c;a.scale(c,c);a.globalAlpha=.4;a.fillStyle="#000000";a.fillRect(0,0,
200,b);a.globalAlpha=1;a.fillStyle="#FFFFFF";c=null;c="Leaderboard";a.font="30px Ubuntu";a.fillText(c,100-a.measureText(c).width/2,40);a.font="20px Ubuntu";for(b=0;b<z.length;++b)c=z[b]||"An unnamed cell",ba||0!=n.length&&n[0].name==c||(c="An unnamed cell"),c=b+1+". "+c,a.fillText(c,100-a.measureText(c).width/2,70+24*b)}}function Ca(a){if(M)return null;a=a.toLowerCase();if(-1==Da.indexOf(a))return null;N.hasOwnProperty(a)||(N[a]=new Image,N[a].src="skins/"+a+".png");return N[a]}function na(a,b,c,d,g,e,h){r.push(this);y[a]=this;this.id=a;this.ox=this.x=b;this.oy=this.y=c;this.oSize=this.size=d;this.color=g;this.isVirus=e;this.points=[];this.pointsAcc=[];this.createPoints();this.setName(h)}function ma(a){for(a=a.toString(16);6>a.length;)a="0"+a;return"#"+a}function ca(a,b,c,d){a&&(this._size=a);b&&(this._color=b);this._stroke=!!c;d&&(this._strokeColor=d)}if("agar.io"!=g.location.hostname&&"localhost"!=g.location.hostname&&"10.10.2.13"!=g.location.hostname)g.location="http://agar.io/";else{var O,d,A,m,p,T=null,h=null,w=0,x=0,D=[],n=[],y={},r=[],E=[],z=[],P=0,Q=0,J=-1,K=-1,za=0,F=0,H=null,V=0,W=0,X=1E4,Y=1E4,s=1,U=null,qa=!0,ba=!0,M=!1,Z=!1,I=0,$=!1,ea="ontouchstart"in g&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),aa=new Image;aa.src="img/split.png";var L=null;g.setNick=function(a){v("#adsBottom").hide();H=a;la();v("#overlays").hide();I=0};g.setRegion=ha;g.setSkins=function(a){qa=a};g.setNames=function(a){ba=a};g.setDarkTheme=function(a){$=a};g.setColors=function(a){M=a};g.connect=ka;var oa=-1,pa=-1,B=null,q=1,N={},Da="poland;usa;china;russia;canada;australia;spain;brazil;germany;ukraine;france;sweden;hitler;north korea;south korea;japan;united kingdom;earth;greece;latvia;lithuania;estonia;finland;norway;cia;maldivas;austria;nigeria;reddit;yaranaika;confederate;9gag;indiana;4chan;italy;ussr;pewdiepie;bulgaria;tumblr;2ch.hk;hong kong;portugal;jamaica;german empire;mexico;sanik;switzerland;croatia;chile;indonesia;bangladesh;thailand;iran;iraq;peru;moon;botswana;bosnia;netherlands;european union;taiwan;pakistan;hungary;satanist;qing dynasty;nazi;matriarchy;patriarchy;feminism;ireland;texas;facepunch;prodota;cambodia;steam;piccolo;ea;india;kc;denmark;quebec;ayy lmao;sealand;bait;tsarist russia;origin;vinesauce;stalin;belgium;luxembourg;stussy;prussia".split(";");na.prototype={id:0,points:null,pointsAcc:null,name:null,nameCache:null,sizeCache:null,x:0,y:0,size:0,ox:0,oy:0,oSize:0,nx:0,ny:0,nSize:0,updateTime:0,updateCode:0,drawTime:0,destroyed:!1,isVirus:!1,destroy:function(){var a;for(a=0;a<r.length;a++)if(r[a]==this){r.splice(a,1);break}delete y[this.id];a=n.indexOf(this);-1!=a&&(Z=!0,n.splice(a,1));a=D.indexOf(this.id);-1!=a&&D.splice(a,1);this.destroyed=!0;E.push(this)},getNameSize:function(){return Math.max(~~(.3*this.size),24)},setName:function(a){if(this.name=a)null==this.nameCache?this.nameCache=new ca(this.getNameSize(),"#FFFFFF",!0,"#000000"):this.nameCache.setSize(this.getNameSize()),this.nameCache.setValue(this.name)},createPoints:function(){for(var a=this.getNumPoints();this.points.length>a;){var b=~~(Math.random()*this.points.length);this.points.splice(b,1);this.pointsAcc.splice(b,1)}0==this.points.length&&0<a&&(this.points.push({c:this,v:this.size,x:this.x,y:this.y}),this.pointsAcc.push(Math.random()-.5));for(;this.points.length<a;){var b=~~(Math.random()*this.points.length),c=this.points[b];this.points.splice(b,0,{c:this,v:c.v,x:c.x,y:c.y});this.pointsAcc.splice(b,0,this.pointsAcc[b])}},getNumPoints:function(){return~~Math.max(this.size*s*(this.isVirus?Math.min(2*q,1):q),this.isVirus?10:5)},movePoints:function(){this.createPoints();for(var a=this.points,b=this.pointsAcc,c=b.concat(),d=a.concat(),g=d.length,e=0;e<g;++e){var h=c[(e-1+g)%g],k=c[(e+1)%g];b[e]+=Math.random()-.5;b[e]*=.7;10<b[e]&&(b[e]=10);-10>b[e]&&(b[e]=-10);b[e]=(h+k+8*b[e])/10}for(var m=
this,e=0;e<g;++e){c=d[e].v;h=d[(e-1+g)%g].v;k=d[(e+1)%g].v;if(15<this.size){var n=!1,l=a[e].x,p=a[e].y;T.retrieve2(l-5,p-5,10,10,function(a){a.c!=m&&25>(l-a.x)*(l-a.x)+(p-a.y)*(p-a.y)&&(n=!0)});!n&&(a[e].x<V||a[e].y<W||a[e].x>X||a[e].y>Y)&&(n=!0);n&&(0<b[e]&&(b[e]=0),b[e]-=1)}c+=b[e];0>c&&(c=0);c=(12*c+this.size)/13;a[e].v=(h+k+8*c)/10;h=2*Math.PI/g;k=this.points[e].v;this.isVirus&&0==e%2&&(k+=5);a[e].x=this.x+Math.cos(h*e)*k;a[e].y=this.y+Math.sin(h*e)*k}},updatePos:function(){var a;a=(F-this.updateTime)/
120;a=0>a?0:1<a?1:a;a=a*a*(3-2*a);var b=this.getNameSize();if(this.destroyed&&1<=a){var c=E.indexOf(this);-1!=c&&E.splice(c,1)}this.x=a*(this.nx-this.ox)+this.ox;this.y=a*(this.ny-this.oy)+this.oy;this.size=a*(this.nSize-this.oSize)+this.oSize;this.destroyed||b==this.getNameSize()||this.setName(this.name);return a},shouldRender:function(){return this.x+this.size+40<w-m/2/s||this.y+this.size+40<x-p/2/s||this.x-this.size-40>w+m/2/s||this.y-this.size-40>x+p/2/s?!1:!0},draw:function(){if(this.shouldRender()){d.save();this.drawTime=F;var a=this.updatePos();this.destroyed&&(d.globalAlpha*=1-a);this.movePoints();M?(d.fillStyle="#FFFFFF",d.strokeStyle="#AAAAAA"):(d.fillStyle=this.color,d.strokeStyle=this.color);d.beginPath();d.lineWidth=10;d.lineCap="round";d.lineJoin=this.isVirus?"mitter":"round";for(var a=this.getNumPoints(),b=0;b<=a;++b){var c=b%a;0==b?d.moveTo(this.points[c].x,this.points[c].y):d.lineTo(this.points[c].x,this.points[c].y)}d.closePath();a=qa?Ca(this.name):null;d.stroke();d.fill();null!=a&&0<a.width&&(d.save(),d.clip(),d.drawImage(a,this.x-this.size,this.y-this.size,2*this.size,2*this.size),d.restore());if(M||15<this.size)d.strokeStyle="#000000",d.globalAlpha*=.1,d.stroke();d.globalAlpha=1;a=-1!=n.indexOf(this);b=~~this.y;(ba||a)&&this.name&&this.nameCache&&(c=this.nameCache.render(),d.drawImage(c,~~this.x-~~(c.width/2),b-~~(c.height/2)),b+=c.height/2+4);a&&(null==this.sizeCache&&(this.sizeCache=new ca(this.getNameSize()/2,"#FFFFFF",!0,"#000000")),this.sizeCache.setValue(~~(this.size*this.size/
100)),c=this.sizeCache.render(),d.drawImage(c,~~this.x-~~(c.width/2),b-~~(c.height/2)));d.restore()}}};ca.prototype={_value:"",_color:"#000000",_stroke:!1,_strokeColor:"#000000",_size:16,_canvas:null,_ctx:null,_dirty:!1,setSize:function(a){this._size!=a&&(this._size=a,this._dirty=!0)},setColor:function(a){this._color!=a&&(this._color=a,this._dirty=!0)},setStroke:function(a){this._stroke!=a&&(this._stroke=a,this._dirty=!0)},setStrokeColor:function(a){this._strokeColor!=a&&(this._strokeColor=a,this._dirty=!0)},setValue:function(a){a!=this._value&&(this._value=a,this._dirty=!0)},render:function(){null==this._canvas&&(this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"));if(this._dirty){var a=this._canvas,b=this._ctx,c=this._value,d=this._size,g=d+"px Ubuntu";b.font=g;var e=b.measureText(c).width,h=~~(.2*d);a.width=e+6;a.height=d+h;b.font=g;b.globalAlpha=1;b.lineWidth=3;b.strokeStyle=this._strokeColor;b.fillStyle=this._color;this._stroke&&b.strokeText(c,3,d-h/2);b.fillText(c,3,d-h/2)}return this._canvas}};g.onload=ra}})(window,jQuery);